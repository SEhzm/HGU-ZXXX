import{r as g,K as Ie,L as Ue,j as p,A as le,o as i,c as M,G as b,T as oe,f as o,d as e,e as a,k as x,F as ae,B as te,l as m,p as c,R as $,m as V,D as B,x as ke,v as Se,a0 as ue}from"./index-D_Na45nS.js";import{l as Ae,a as Ee,u as xe,b as Te,d as Ne,c as Re}from"./course-T-tvQdpF.js";var Ye={VITE_APP_TITLE:"在线学习平台（圆桌组）",VITE_APP_ENV:"production",VITE_APP_BASE_API:"/prod-api",VITE_BUILD_COMPRESS:"gzip",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const Pe={class:"app-container"},Me=V("div",{class:"el-upload__text"},[c(" 将文件拖拽进来 "),V("em",null,"或 点击上传")],-1),$e=V("div",{class:"el-upload__tip"}," 上传图片，最大500kb ",-1),Be={class:"dialog-footer"},Fe=V("div",{class:"el-upload__text"},[c(" 将文件拖拽进来 "),V("em",null,"或 点击上传")],-1),Le=V("div",{class:"el-upload__tip"}," 上传视频文件，最大200MB ",-1),qe={class:"dialog-footer"},Ke=ke({name:"Course"}),je=Object.assign(Ke,{setup(ze){const{proxy:v}=Se(),{course_category:T}=v.useDict("course_category"),F=g([]),y=g(!1),w=g(!1),N=g(!0),U=g(!0),R=g([]),L=g(!0),q=g(!0),Y=g(0),k=g(""),C=Ie({form:{},queryParams:{pageNum:1,pageSize:10,courseName:null,courseDescription:null,userId:null,createdAt:null,updatedAt:null,teacher:null,courseCategory:null,chapterId:null,courseId:null,chapterTitle:null,chapterDescription:null,videoUrl:null,position:null},rules:{}}),{queryParams:d,form:r,rules:K}=Ue(C),z=Ye.SERVER_ADDRESS;g([]);const re=async u=>{const t=new FormData;t.append("file",u.file);try{const s=await ue.post(`${z}/file/upload`,t,{headers:{"Content-Type":"multipart/form-data"}}).then(n=>{C.form.videoUrl=n.data,console.log(C.form.videoUrl)});u.onSuccess&&u.onSuccess(s.data)}catch(s){u.onError&&u.onError(s)}},ne=async u=>{const t=new FormData;t.append("file",u.file);try{const s=await ue.post(`${z}/file/upload`,t,{headers:{"Content-Type":"multipart/form-data"}}).then(n=>{C.form.courseImg=n.data,console.log(C.form.courseImg)});u.onSuccess&&u.onSuccess(s.data)}catch(s){u.onError&&u.onError(s)}},O=u=>{console.log("上传成功"+u),ElMessage({message:"上传成功",type:"success"})};function h(){N.value=!0,Ae(d.value).then(u=>{F.value=u.rows,Y.value=u.total,N.value=!1})}function Q(){w.value=!1,y.value=!1,S()}function S(){r.value={courseId:null,courseName:null,courseDescription:null,userId:null,createdAt:null,updatedAt:null,teacher:null,courseCategory:null,courseImg:null},v.resetForm("courseRef")}function I(){d.value.pageNum=1,h()}function de(){v.resetForm("queryRef"),I()}function se(u){R.value=u.map(t=>t.courseId),L.value=u.length!=1,q.value=!u.length}function pe(){S(),y.value=!0,k.value="添加course"}function j(u){S();const t=u.courseId||R.value;Ee(t).then(s=>{r.value=s.data,y.value=!0,k.value="修改course"})}function ce(){v.$refs.courseRef.validate(u=>{u&&(r.value.courseId!=null?xe(r.value).then(t=>{v.$modal.msgSuccess("修改成功"),y.value=!1,h()}):Te(r.value).then(t=>{v.$modal.msgSuccess("新增成功"),y.value=!1,h()}))})}function G(u){const t=u.courseId||R.value;v.$modal.confirm('是否确认删除course编号为"'+t+'"的数据项？').then(function(){return Ne(t)}).then(()=>{h(),v.$modal.msgSuccess("删除成功")}).catch(()=>{})}function ie(u){S(),w.value=!0,this.form.courseId=u.courseId}function me(){Re(r.value).then(u=>{v.$modal.msgSuccess("新增成功"),w.value=!1,h()})}function fe(){v.download("course/course/export",{...d.value},`course_${new Date().getTime()}.xlsx`)}return h(),(u,t)=>{const s=p("el-input"),n=p("el-form-item"),A=p("el-date-picker"),_e=p("el-option"),ge=p("el-select"),f=p("el-button"),P=p("el-form"),E=p("el-col"),ve=p("right-toolbar"),be=p("el-row"),_=p("el-table-column"),Ve=p("dict-tag"),ye=p("el-table"),he=p("pagination"),Ce=p("el-radio"),De=p("el-radio-group"),H=p("el-tag"),J=p("upload-filled"),W=p("el-icon"),X=p("el-upload"),Z=p("el-dialog"),D=le("hasPermi"),we=le("loading");return i(),M("div",Pe,[b(e(P,{model:o(d),ref:"queryRef",inline:!0,"label-width":"68px"},{default:a(()=>[e(n,{label:"课程名",prop:"courseName"},{default:a(()=>[e(s,{modelValue:o(d).courseName,"onUpdate:modelValue":t[0]||(t[0]=l=>o(d).courseName=l),placeholder:"请输入课程名",clearable:"",onKeyup:x(I,["enter"])},null,8,["modelValue"])]),_:1}),e(n,{label:"课程简介",prop:"courseDescription"},{default:a(()=>[e(s,{modelValue:o(d).courseDescription,"onUpdate:modelValue":t[1]||(t[1]=l=>o(d).courseDescription=l),placeholder:"请输入课程简介",clearable:"",onKeyup:x(I,["enter"])},null,8,["modelValue"])]),_:1}),e(n,{label:"创建者id",prop:"userId"},{default:a(()=>[e(s,{modelValue:o(d).userId,"onUpdate:modelValue":t[2]||(t[2]=l=>o(d).userId=l),placeholder:"请输入创建者id",clearable:"",onKeyup:x(I,["enter"])},null,8,["modelValue"])]),_:1}),e(n,{label:"创建时间",prop:"createdAt"},{default:a(()=>[e(A,{clearable:"",modelValue:o(d).createdAt,"onUpdate:modelValue":t[3]||(t[3]=l=>o(d).createdAt=l),type:"date","value-format":"YYYY-MM-DD",placeholder:"请选择创建时间"},null,8,["modelValue"])]),_:1}),e(n,{label:"更新时间",prop:"updatedAt"},{default:a(()=>[e(A,{clearable:"",modelValue:o(d).updatedAt,"onUpdate:modelValue":t[4]||(t[4]=l=>o(d).updatedAt=l),type:"date","value-format":"YYYY-MM-DD",placeholder:"请选择更新时间"},null,8,["modelValue"])]),_:1}),e(n,{label:"讲师",prop:"teacher"},{default:a(()=>[e(s,{modelValue:o(d).teacher,"onUpdate:modelValue":t[5]||(t[5]=l=>o(d).teacher=l),placeholder:"请输入讲师",clearable:"",onKeyup:x(I,["enter"])},null,8,["modelValue"])]),_:1}),e(n,{label:"课程分类",prop:"courseCategory"},{default:a(()=>[e(ge,{modelValue:o(d).courseCategory,"onUpdate:modelValue":t[6]||(t[6]=l=>o(d).courseCategory=l),placeholder:"请选择课程分类",clearable:""},{default:a(()=>[(i(!0),M(ae,null,te(o(T),l=>(i(),m(_e,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(n,null,{default:a(()=>[e(f,{type:"primary",icon:"Search",onClick:I},{default:a(()=>[c("搜索")]),_:1}),e(f,{icon:"Refresh",onClick:de},{default:a(()=>[c("重置")]),_:1})]),_:1})]),_:1},8,["model"]),[[oe,o(U)]]),e(be,{gutter:10,class:"mb8"},{default:a(()=>[e(E,{span:1.5},{default:a(()=>[b((i(),m(f,{type:"primary",plain:"",icon:"Plus",onClick:pe},{default:a(()=>[c("新增 ")]),_:1})),[[D,["course:course:add"]]])]),_:1}),e(E,{span:1.5},{default:a(()=>[b((i(),m(f,{type:"success",plain:"",icon:"Edit",disabled:o(L),onClick:j},{default:a(()=>[c("修改 ")]),_:1},8,["disabled"])),[[D,["course:course:edit"]]])]),_:1}),e(E,{span:1.5},{default:a(()=>[b((i(),m(f,{type:"danger",plain:"",icon:"Delete",disabled:o(q),onClick:G},{default:a(()=>[c("删除 ")]),_:1},8,["disabled"])),[[D,["course:course:remove"]]])]),_:1}),e(E,{span:1.5},{default:a(()=>[b((i(),m(f,{type:"warning",plain:"",icon:"Download",onClick:fe},{default:a(()=>[c("导出 ")]),_:1})),[[D,["course:course:export"]]])]),_:1}),e(ve,{showSearch:o(U),"onUpdate:showSearch":t[7]||(t[7]=l=>$(U)?U.value=l:null),onQueryTable:h},null,8,["showSearch"])]),_:1}),b((i(),m(ye,{data:o(F),onSelectionChange:se},{default:a(()=>[e(_,{type:"selection",width:"55",align:"center"}),e(_,{label:"课程id",align:"center",prop:"courseId"}),e(_,{label:"课程名",align:"center",prop:"courseName"}),e(_,{label:"课程简介",align:"center",prop:"courseDescription","show-overflow-tooltip":""}),e(_,{label:"创建者id",align:"center",prop:"userId"}),e(_,{label:"创建时间",align:"center",prop:"createdAt",width:"180"},{default:a(l=>[V("span",null,B(u.parseTime(l.row.createdAt,"{y}-{m}-{d}")),1)]),_:1}),e(_,{label:"更新时间",align:"center",prop:"updatedAt",width:"180"},{default:a(l=>[V("span",null,B(u.parseTime(l.row.updatedAt,"{y}-{m}-{d}")),1)]),_:1}),e(_,{label:"讲师",align:"center",prop:"teacher"}),e(_,{label:"课程分类",align:"center",prop:"courseCategory"},{default:a(l=>[e(Ve,{options:o(T),value:l.row.courseCategory},null,8,["options","value"])]),_:1}),e(_,{label:"课程封面",align:"center",prop:"courseImg","show-overflow-tooltip":""}),e(_,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:a(l=>[b((i(),m(f,{link:"",type:"primary",icon:"Edit",onClick:ee=>j(l.row)},{default:a(()=>[c("修改 ")]),_:2},1032,["onClick"])),[[D,["course:course:edit"]]]),b((i(),m(f,{link:"",type:"primary",icon:"Delete",onClick:ee=>G(l.row)},{default:a(()=>[c("删除 ")]),_:2},1032,["onClick"])),[[D,["course:course:remove"]]]),b((i(),m(f,{link:"",type:"primary",onClick:ee=>ie(l.row)},{default:a(()=>[c(" 上传章节 ")]),_:2},1032,["onClick"])),[[D,["course:course:add"]]])]),_:1})]),_:1},8,["data"])),[[we,o(N)]]),b(e(he,{total:o(Y),page:o(d).pageNum,"onUpdate:page":t[8]||(t[8]=l=>o(d).pageNum=l),limit:o(d).pageSize,"onUpdate:limit":t[9]||(t[9]=l=>o(d).pageSize=l),onPagination:h},null,8,["total","page","limit"]),[[oe,o(Y)>0]]),e(Z,{title:o(k),modelValue:o(y),"onUpdate:modelValue":t[17]||(t[17]=l=>$(y)?y.value=l:null),width:"500px","append-to-body":""},{footer:a(()=>[V("div",Be,[e(f,{type:"primary",onClick:ce},{default:a(()=>[c("确 定")]),_:1}),e(f,{onClick:Q},{default:a(()=>[c("取 消")]),_:1})])]),default:a(()=>[e(P,{ref:"courseRef",model:o(r),rules:o(K),"label-width":"80px"},{default:a(()=>[e(n,{label:"课程名",prop:"courseName"},{default:a(()=>[e(s,{modelValue:o(r).courseName,"onUpdate:modelValue":t[10]||(t[10]=l=>o(r).courseName=l),placeholder:"请输入课程名"},null,8,["modelValue"])]),_:1}),e(n,{label:"课程简介",prop:"courseDescription"},{default:a(()=>[e(s,{modelValue:o(r).courseDescription,"onUpdate:modelValue":t[11]||(t[11]=l=>o(r).courseDescription=l),placeholder:"请输入课程简介"},null,8,["modelValue"])]),_:1}),e(n,{label:"创建者id",prop:"userId"},{default:a(()=>[e(s,{modelValue:o(r).userId,"onUpdate:modelValue":t[12]||(t[12]=l=>o(r).userId=l),placeholder:"请输入创建者id"},null,8,["modelValue"])]),_:1}),e(n,{label:"创建时间",prop:"createdAt"},{default:a(()=>[e(A,{clearable:"",modelValue:o(r).createdAt,"onUpdate:modelValue":t[13]||(t[13]=l=>o(r).createdAt=l),type:"date","value-format":"YYYY-MM-DD",placeholder:"请选择创建时间"},null,8,["modelValue"])]),_:1}),e(n,{label:"更新时间",prop:"updatedAt"},{default:a(()=>[e(A,{clearable:"",modelValue:o(r).updatedAt,"onUpdate:modelValue":t[14]||(t[14]=l=>o(r).updatedAt=l),type:"date","value-format":"YYYY-MM-DD",placeholder:"请选择更新时间"},null,8,["modelValue"])]),_:1}),e(n,{label:"讲师",prop:"teacher"},{default:a(()=>[e(s,{modelValue:o(r).teacher,"onUpdate:modelValue":t[15]||(t[15]=l=>o(r).teacher=l),placeholder:"请输入讲师"},null,8,["modelValue"])]),_:1}),e(n,{label:"课程分类",prop:"courseCategory"},{default:a(()=>[e(De,{modelValue:o(r).courseCategory,"onUpdate:modelValue":t[16]||(t[16]=l=>o(r).courseCategory=l)},{default:a(()=>[(i(!0),M(ae,null,te(o(T),l=>(i(),m(Ce,{key:l.value,label:l.value},{default:a(()=>[c(B(l.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(n,{label:"课程封面",prop:"courseImg"},{default:a(()=>[o(C).form.courseImg?(i(),m(H,{key:0},{default:a(()=>[c("已上传")]),_:1})):(i(),m(X,{key:1,style:{width:"100%"},class:"upload-demo",drag:"",multiple:"","http-request":ne,"on-success":O,accept:"image/*"},{tip:a(()=>[$e]),default:a(()=>[e(W,{class:"el-icon--upload"},{default:a(()=>[e(J)]),_:1}),Me]),_:1}))]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"]),e(Z,{title:o(k),modelValue:o(w),"onUpdate:modelValue":t[22]||(t[22]=l=>$(w)?w.value=l:null),width:"500px","append-to-body":""},{footer:a(()=>[V("div",qe,[e(f,{type:"primary",onClick:me},{default:a(()=>[c("确 定")]),_:1}),e(f,{onClick:Q},{default:a(()=>[c("取 消")]),_:1})])]),default:a(()=>[e(P,{ref:"chaptersRef",model:o(r),rules:o(K),"label-width":"80px"},{default:a(()=>[e(n,{label:"课程id",prop:"courseId"},{default:a(()=>[e(s,{disabled:"",modelValue:o(r).courseId,"onUpdate:modelValue":t[18]||(t[18]=l=>o(r).courseId=l),placeholder:""},null,8,["modelValue"])]),_:1}),e(n,{label:"章节标题",prop:"chapterTitle"},{default:a(()=>[e(s,{modelValue:o(r).chapterTitle,"onUpdate:modelValue":t[19]||(t[19]=l=>o(r).chapterTitle=l),placeholder:"请输入章节标题"},null,8,["modelValue"])]),_:1}),e(n,{label:"章节描述",prop:"chapterDescription"},{default:a(()=>[e(s,{modelValue:o(r).chapterDescription,"onUpdate:modelValue":t[20]||(t[20]=l=>o(r).chapterDescription=l),placeholder:"请输入章节描述"},null,8,["modelValue"])]),_:1}),e(n,{label:"视频链接",prop:"videoUrl"},{default:a(()=>[o(C).form.videoUrl?(i(),m(H,{key:0},{default:a(()=>[c("已上传")]),_:1})):(i(),m(X,{key:1,style:{width:"100%"},class:"upload-demo",drag:"",multiple:"",accept:"video/*","http-request":re,"on-success":O},{tip:a(()=>[Le]),default:a(()=>[e(W,{class:"el-icon--upload"},{default:a(()=>[e(J)]),_:1}),Fe]),_:1}))]),_:1}),e(n,{label:"章节顺序",prop:"position"},{default:a(()=>[e(s,{modelValue:o(r).position,"onUpdate:modelValue":t[21]||(t[21]=l=>o(r).position=l),placeholder:"请输入章节顺序"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}});export{je as default};
